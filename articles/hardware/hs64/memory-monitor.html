<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Headstage64 Memory Monitor </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Headstage64 Memory Monitor ">
      
      
      <link rel="icon" href="../../../favicon.png">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/open-ephys/bonsai-onix1-docs/blob/main/articles/hardware/hs64/memory-monitor.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" class="svg" src="../../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="hs64_memory-monitor">
          <h1>Headstage64 Memory Monitor</h1>



  
  
<p>The following excerpt from the Breakout Board <a class="xref" href="../breakout/workflow.html">example workflow</a> demonstrates memory monitor functionality and saves memory monitor data.</p>
<div class="workflow"><p><img src="../../../workflows/hardware/breakout/memory-monitor.bonsai" alt="/workflows/hardware/breakout/memory-monitor.bonsai workflow"></p>
</div>
<p>The <a class="xref" href="../../../api/OpenEphys.Onix1.MemoryMonitorData.html">MemoryMonitorData</a> operator generates a sequence of <a class="xref" href="../../../api/OpenEphys.Onix1.MemoryMonitorDataFrame.html">MemoryMonitorDataFrame</a>s. <code>MemoryMonitorData</code> emits <code>MemoryMonitorDataFrame</code>s at a regular interval defined during <a class="xref" href="../breakout/configuration.html">Breakout Board Configuration</a> using the <a class="xref" href="../../../api/OpenEphys.Onix1.ConfigureBreakoutBoard.html">ConfigureBreakoutBoard</a>'s <code>MemoryMonitor SamplesPerSecond</code> property (in our case 10 Hz). In the Breakout Board example workflow, the <code>MemoryMonitorData</code>'s <code>DeviceName</code> property is set to &quot;BreakoutBoard/MemoryMonitor&quot;. This links the <code>MemoryMonitorData</code> operator to the corresponding configuration operator. The <a href="https://bonsai-rx.org/docs/api/Bonsai.IO.CsvWriter.html">CsvWriter</a> operator saves the <code>Clock</code>, <code>BytesUsed</code>, and <code>PercentUsed</code> members to a file with the following format: <code>memory-use_&lt;timestamp&gt;.csv</code>. Because <code>CsvWriter</code> is a <em>sink</em> operator, its output sequence is equivalent to its input sequence. In other words, its output is equivalent to <code>MemoryMonitorData</code>'s output. Therefore, it's possible to use a <a href="https://bonsai-rx.org/docs/api/Bonsai.Expressions.MemberSelectorBuilder.html">MemberSelector</a> operator on the <code>CsvWriter</code> to select members from the <code>MemoryMonitorDataFrame</code>. The <code>MemberSelector</code> operator selects the <code>PercentUsed</code> member from the <code>MemoryMonitorDataFrame</code> so the user can visualize <code>PercentUsed</code> data from the <code>MemoryMonitorDataFrame</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>The <code>MemoryMonitorDataFrame</code> operator generates a
data stream that is most useful in the context of closed-loop performance. It tells the user if data
is being consumed rapidly enough by the host PC to keep up with data production by the hardware. The
hardware FIFO is a buffer that is required to deal with the fact that computers with normal
operating systems cannot perform operations with strict regularity. When there are hiccups in
acquisition, the hardware FIFO picks up the slack, but should then be cleared immediately. To get
the lowest latencies, the <code>BlockReadSize</code> should be as small as possible <em>while the memory use
percentage remains around 0%</em>.</p>
</div>
<div class="WARNING">
<h5>Warning</h5>
<p>If the hardware FIFO's <code>PercentUsed</code> is non-zero for long time periods, or is increasing, the
<code>StartAcquisition</code>'s <code>BlockReadSize</code> setting is too small (see the <a class="xref" href="../breakout/configuration.html">breakout board configuration</a>). A small
<code>BlockReadSize</code> will mean that the host computer does not have to wait long for enough data to
become available to propagate it forward, but will reduce overall bandwidth by increasing the
frequency at which the host computer checks if data is available and performs hardware reads.</p>
</div>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/open-ephys/bonsai-onix1-docs/blob/main/articles/hardware/hs64/memory-monitor.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          &copy; 2024 Open Ephys and Contributors. Made with <a href="https://dotnet.github.io/docfx">docfx</a>
        </div>
      </div>
    </footer>
  </body>
</html>
